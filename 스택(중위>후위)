//<스택 (중위-> 후위)>
#include <stdio.h>
#include <string.h>
#include <ctype.h>
#include <stdlib.h>

#define MAX_STACK_SIZE 100

// ----- 스택 관련 전역 -----
typedef int element;
element stack[MAX_STACK_SIZE];
int top;

// ----- 스택 관련 함수들 -----
void init_stack()
{
    top = -1; // 스택 초기화
}
int is_empty()
{
    return (top == -1);
}
int is_full()
{
    return (top == MAX_STACK_SIZE - 1);
}
int size()
{
    return top + 1;
}
void push(element item)
{
    if (!is_full())
        stack[++top] = item;
}
element pop()
{
    if (is_empty())
        return -1; // 언더플로우 방지
    return stack[top--];
}
element peek()
{
    if (is_empty())
        return -1;
    return stack[top];
}

// ----- 연산자 우선순위 함수 -----
int prec(char op)
{
    // FILL the code
    if (op == '*' || op == '/') return 2;
    else if (op == '+' || op == '-') return 1;
    else if (op == '(') return 0;
    else return -1;
}

// ----- 중위 -> 후위 변환 함수 -----
// 입력: infix_expr (중위 표기 수식)
// 출력: postfix_expr (후위 표기 수식)
void infix_to_postfix(char infix_expr[], char postfix_expr[])
{
    // FILL the code
    char ch, top_op;
    int j = 0;
    int len = strlen(infix_expr);
    int digit = 0;

    for (int i = 0; i < len; i++) {
        ch = infix_expr[i];

        if (isdigit(ch)) {
            postfix_expr[j++] = ch;
            digit = 1;
        }
        else {
            if (digit) {
                postfix_expr[j++] = ' ';
                digit = 0;
            }

            if (ch == '(') {
                push(ch);
            }
            else if (ch == ')') {
                while ((top_op = pop()) != '(') {
                    postfix_expr[j++] = top_op;
                    postfix_expr[j++] = ' ';
                }
            }
            else if (ch == '+' || ch == '-' || ch == '*' || ch == '/') {
                while (!is_empty() && (prec(ch) <= prec(peek()))) {
                    postfix_expr[j++] = pop();
                    postfix_expr[j++] = ' ';
                }
                push(ch);
            }
        }
    }

    while (!is_empty()) {
        if (digit) {
            postfix_expr[j++] = ' '; 
            digit = 0;
        }
        postfix_expr[j++] = pop();
        postfix_expr[j++] = ' ';
    }

    postfix_expr[j] = '\0';
}

// ----- 메인 함수 -----
// 표준 입력에서 중위식을 받아 후위식으로 변환 후 출력
int main()
{
    int i = 0;
    char input_char = 0;
    char infix_expr[1000] = {0};
    char postfix_expr[1000] = {0};

    // 표준 입력으로 중위 표기식 읽기
    while ((input_char = getchar()) != EOF)
        infix_expr[i++] = input_char;
    infix_expr[i] = '\0';

    init_stack();

    // 변환 수행
    infix_to_postfix(infix_expr, postfix_expr);

    // 결과 출력
    printf("%s\n", postfix_expr);

    return 0;
}
